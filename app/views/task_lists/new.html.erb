<div class="container">
  <h1 class="display-4 my-5">Nova Lista</h1>

  <%= form_with model: @task_list do |form| %>
    <div class="form-group row form-check">
      <%= form.label(:status, "Privada") %>
      <%= form.radio_button(:status, :personal, checked: true, class:'mr-3') %>
      <%= form.label(:status, "Pública") %>
      <%= form.radio_button(:status, :shared) %>
    </div>
    <div class="form-group row">
      <%= form.label :name, 'Nome:', class:"col-sm-2" %>
      <%= form.text_field :name, class:"form-control col-sm-10" %>
    </div>
    <div class="form-group row">
      <%= form.fields_for :tasks do |f| %>
        <%= render 'task_fields', f: f %>
      <% end %>
      <%= link_to_add_fields('Nova tarefa', form, :tasks) %>
    </div>
    <div class="form-group row">
      <div class="col-sm-5">
          <%= form.submit 'Salvar', class: "btn btn-dark" %>
      </div>
    </div>
  <% end %>

  <div class="col-sm-10">
      <% if @task_list.errors.any?%>
          <p>Você deve corrigir os erros para continuar:</p>
          <% @task_list.errors.full_messages.each do |message|  %>
              <p><%= message %></p>
          <% end %>
      <% end %>
  </div>
  <%= link_to 'Voltar', task_lists_path, class:"btn btn-outline-dark" %>
</div>

<script>
  $('form').on('click', '.add_fields', function(even){
    var regexp, time;
    time = new Date().getTime();
    regexp = new RegExp($(this).data('id'), 'g');
    $(this).before($(this).data('fields').replace(regexp, time));
    return event.preventDefault();
  });
</script>